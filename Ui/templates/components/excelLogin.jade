include forms

mixin dropdown(field, rowSource)
	+form-field(field.label)
		select.form-control(name="#{field.fieldName}" data-bind="value: #{field.fieldName}, with: #{rowSource}")
			block

mixin sheets-dropdown()
	+dropdown({label: 'Sheet', fieldName: 'sheet'}, 'sheets')
		//ko foreach: names
		option(data-bind="attr: { label: $data, value: $index}")
		// /ko

mixin row-dropdown(field, rowSource)
	+dropdown(field, rowSource)
		block
		optgroup(data-bind="foreach: names" label="Map this field to:")
			option(data-bind="attr: { label: $data, value: $index}")

mixin optional-row-dropdown(field, rowSource)
	+row-dropdown(field, rowSource)
		option(value="-1" label="No value")

mixin excel-login()
	.form-group
		label.col-sm-2.col-sm-offset-2.control-label File location
		.col-sm-6
			input#excelFileLocation.form-control(type="text" data-bind="textInput: fileLocation" name="fileLocation")
		.col-sm-2
			button.btn.btn-default(type="button", data-bind="click: browseExcelFile") Browse...	
	+sheets-dropdown()
	+checkbox('Header row', 'useHeaderRow')
	+row-dropdown({label: 'Date', fieldName: 'JournalDate'}, 'columns')
	each field in [	{label: 'Nominal code', fieldName: 'AccountCode'}, {label: 'Nominal name', fieldName: 'AccountName'}, {label: 'Amount', fieldName: 'Amount'}, {label: 'Created by', fieldName: 'Username'}, {label: 'Created date', fieldName: 'Created'}, {label: 'Description', fieldName: 'Description'}, {label: 'ID', fieldName: 'Id'}]
		+optional-row-dropdown(field, 'columns')